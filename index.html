renderBtn.addEventListener('click', () => {
    regionTable.innerHTML = ''; // Clear the table
    regionTable.style.display = 'block'; // Show the table

    // Create clickable regions based on detected areas
    canvas.addEventListener('click', (event) => {
        const rect = canvas.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;

        // Check if a region is clicked
        regions.forEach((region, index) => {
            if (
                x >= region.x && x <= region.x + region.width &&
                y >= region.y && y <= region.y + region.height
            ) {
                // Set the selected region
                selectedRegion = region;
                selectedRegion.index = index;

                // Highlight the selected region
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0);
                regions.forEach(r => {
                    if (r !== selectedRegion) {
                        ctx.strokeStyle = 'red';
                        ctx.lineWidth = 2;
                        ctx.strokeRect(r.x, r.y, r.width, r.height);
                    }
                });
                ctx.strokeStyle = 'blue';
                ctx.lineWidth = 2;
                ctx.strokeRect(selectedRegion.x, selectedRegion.y, selectedRegion.width, selectedRegion.height);

                // Prompt for region name
                const regionName = prompt('Enter a name for this region:');
                if (regionName) {
                    // Add the name and color to the table
                    const row = regionTable.insertRow();
                    row.insertCell(0).textContent = regionName;
                    row.insertCell(1).textContent = selectedColor;
                    row.insertCell(2).textContent = `${selectedRegion.x}, ${selectedRegion.y}`;
                    row.insertCell(3).textContent = `${selectedRegion.width}, ${selectedRegion.height}`;
                }

                // Ensure the table is visible after entering the name
                regionTable.style.display = 'block';
            }
        });
    });
});
